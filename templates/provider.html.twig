
{% extends "main.html.twig" %}

{% block spreadsheets %}
	{{ parent() }}

    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/dataTables.uikit.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.uikit.min.css" />
    <link rel="stylesheet" href="{{ asset("css/examTable.css")}}" />
{% endblock %}

{% block title %}CertifyTN - {{provider.name}} Certifications and Exams {% endblock %}

{% block breadcrumb %}
    <li><a href="{{path("index")}}">Home</a></li>
    <li class="uk-disabled"><a>{{provider.name}}</a></li>
    {# <li class="uk-disabled"><a>Disabled Category</a></li>
    <li><span>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</span></li> #}
{% endblock %}

{% block content %}

{% if provider.getCertifications().count > 0 %}
    <div style = "margin-top:15px; padding: 10px 10px 20px">

        <h3 class = "uk-table-header"> {{provider.name}} Certifications ({{provider.getCertifications().count}})</h3>
        <div class="uk-slider-container-offset" uk-slider="autoplay: true">

            <div class="uk-position-relative uk-visible-toggle" tabindex="-1">

                <ul class="uk-slider-items uk-child-width-1-2  uk-child-width-1-3@m uk-grid">
                    {% for certif in provider.getCertifications() %}
                    <li>
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-media-top">
                                <a class = "uk-link-muted" href = "{{path("certif_view", {"id": certif.id})}}"><img src="{{ asset(certif.getThumbnailPath() ) }}" style = "width: 450px; height: 300px;" alt="{{certif.title}}"></a>
                            </div>
                            <div class="uk-card-body">
                                <h3 class="uk-card-title"><a class = "uk-link-muted" href = "{{path("certif_view", {"id": certif.id})}}">{{certif.title}}</a></h3>
                                <p>{{certif.description}}</p>
                                {% if logged_in and app.user.isAddedCertif(certif) %}    
                                <a class = "uk-button uk-button-default slider-button" href="{{ path('user_certif_select', {'id': certif.id}) }}">Already enrolled</a>
                                {% else %}

                                <a class = "uk-button uk-button-danger slider-button" href="{{ path('certif_add_coll', {'id': certif.id}) }}">Enroll</a>
                                {% endif %}
                            </div>
                            <div class="uk-card-footer white-footer">
                                <div>
                                <i class = "g-font-size-13">Exams: {{certif.getExams().count}}</i>
                                <i class = "g-font-size-13 uk-float-right">Question Count: {{certif.getCountQ()}}</i>
                                </div>
                            </div>
                        </div>
                    </li>
                {% endfor %}
                </ul>

                <a class="uk-position-center-left uk-position-small uk-hidden-hover" href="#" uk-slidenav-previous uk-slider-item="previous"></a>
                <a class="uk-position-center-right uk-position-small uk-hidden-hover" href="#" uk-slidenav-next uk-slider-item="next"></a>

            </div>

            <ul class="uk-slider-nav uk-dotnav uk-flex-center uk-margin"></ul>

        </div>
    </div>
{% endif %}

<div style = "margin-top:15px; padding: 10px 10px 20px">
        <h3 class = "uk-table-header"> {{provider.name}} Exams ({{provider.getExams().count}})</h3>
    <div style = "padding: 10px 20px;">
        <div class="uk-width-1-1">
            <table id="example" class="uk-table uk-table-hover uk-table-striped dataTable uk-full-width" aria-describedby="example_info">
                <thead>
                    <tr>
                        <th class = "uk-width-small">Code</th>
                        <th class = "uk-width-medium">Title</th>
                        <th>Certification</th>
                        <th>Papers</th>
                        <th>Last Updated At</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for exam in provider.getExams() %}
                        <tr>
                            <td><a href="{{path("exam_view", {"id": exam.code})}}" class = "exam-code"><span class="glyphicon glyphicon-new-window"></span> {{exam.code}}</a></td>
                            <td>{{exam.title}}</td>
                            <td>{{exam.certification.title|default("None")}}</td>
                            <td>{{exam.getExamPapers().count()}}</td>
                            <td>{{exam.getUpdatedAt()|date('Y-m-d H:i:s')}}</td>
                            <td>
                                <button type="button" class="like-button {% if logged_in and app.user.isAddedExam(exam) %} selected {% endif %}" id = "{{exam.id}}">
                                    <svg class="heart-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M91.6 13A28.7 28.7 0 0 0 51 13l-1 1-1-1A28.7 28.7 0 0 0 8.4 53.8l1 1L50 95.3l40.5-40.6 1-1a28.6 28.6 0 0 0 0-40.6z"/></svg>
                                Favourite
                                </button>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="6" class = "uk-no-records-found">no records found</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <script>
            $(document).ready(function () {
                $('#example').dataTable({"aoColumns": [ {"bSearchable": true}, {"bSearchable": true}, {"bSearchable": false}, {"bSearchable": false}, {"bSearchable": false}, {"bSearchable": false}]});

                function redirect_register() {
                    window.location.href = "{{ path('security_registration') }}";
                }

                var isLogged = '{{logged_in}}';
                        
                $('.like-button').click(function() {
                    if (isLogged == '1') {
                    if (($(this).hasClass("selected"))) {
                        $(this).removeClass('selected');
                        $.post("{{ path('exam_remove_coll') }}", {exam_id: $(this).attr("id")});
                    } else {
                        $(this).addClass('selected');
                        $.post("{{ path('exam_add_coll') }}", {exam_id: $(this).attr("id")});
                    }
                    } else {
                        redirect_register();
                    }
                });
           });
        </script>
    </div>
</div>

{% endblock %}
